<!doctype html><html lang=en-us>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="代码"><title>python3实现Vigenere加密、解密、破解</title>
<link rel=canonical href=https://bankroft.github.io/posts/python3%E5%AE%9E%E7%8E%B0vigenere%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E7%A0%B4%E8%A7%A3/>
<link rel=stylesheet href=/scss/style.min.b949db8bead9abdc40291b93383b8da6abc3aa62e74f5580356c06ddbb792dab.css><meta property="og:title" content="python3实现Vigenere加密、解密、破解">
<meta property="og:description" content="代码">
<meta property="og:url" content="https://bankroft.github.io/posts/python3%E5%AE%9E%E7%8E%B0vigenere%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E7%A0%B4%E8%A7%A3/">
<meta property="og:site_name" content="Bankroft">
<meta property="og:type" content="article"><meta property="article:section" content="Posts"><meta property="article:tag" content="python"><meta property="article:tag" content="密码学"><meta property="article:tag" content="Vigenere"><meta property="article:published_time" content="2019-08-01T12:16:06+00:00"><meta property="article:modified_time" content="2019-08-01T12:16:06+00:00">
<meta name=twitter:title content="python3实现Vigenere加密、解密、破解">
<meta name=twitter:description content="代码">
<link rel="shortcut icon" href=/img/favicon.ico>
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"dark")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Back</span>
</a>
</div>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/categories/scripts/>
Scripts
</a>
</header>
<h2 class=article-title>
<a href=/posts/python3%E5%AE%9E%E7%8E%B0vigenere%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E7%A0%B4%E8%A7%A3/>python3实现Vigenere加密、解密、破解</a>
</h2>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 01, 2019</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
3 minute read
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h4 id=代码>代码</h4>
<div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># coding:utf-8</span>
<span style=color:#f92672>import</span> math

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>encryptionVirginia</span>(plaintext, secret_key):
    <span style=color:#e6db74>&#39;&#39;&#39;加密&#39;&#39;&#39;</span>
    table <span style=color:#f92672>=</span> [chr(x) <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> range(ord(<span style=color:#e6db74>&#39;a&#39;</span>), ord(<span style=color:#e6db74>&#39;z&#39;</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)]
    tmp <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
    <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> plaintext:
        <span style=color:#66d9ef>if</span> x<span style=color:#f92672>.</span>lower() <span style=color:#f92672>in</span> table:
            tmp <span style=color:#f92672>+=</span> x<span style=color:#f92672>.</span>lower()
    ciphertext <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>

    <span style=color:#66d9ef>for</span> index, value <span style=color:#f92672>in</span> enumerate(tmp):
        t <span style=color:#f92672>=</span> (table<span style=color:#f92672>.</span>index(value) <span style=color:#f92672>+</span> table<span style=color:#f92672>.</span>index(secret_key[index <span style=color:#f92672>%</span> len(secret_key)])) <span style=color:#f92672>%</span> <span style=color:#ae81ff>26</span>
        ciphertext <span style=color:#f92672>+=</span> table[t]
    <span style=color:#66d9ef>return</span> ciphertext


<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decryptionVirginia</span>(ciphertext, secret_key):
    <span style=color:#e6db74>&#39;&#39;&#39;解密&#39;&#39;&#39;</span>
    ciphertext <span style=color:#f92672>=</span> ciphertext<span style=color:#f92672>.</span>lower()
    table <span style=color:#f92672>=</span> [chr(x) <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> range(ord(<span style=color:#e6db74>&#39;a&#39;</span>), ord(<span style=color:#e6db74>&#39;z&#39;</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)]

    plaintext <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
    num <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
    <span style=color:#66d9ef>for</span> index, value <span style=color:#f92672>in</span> enumerate(ciphertext):
        plaintext <span style=color:#f92672>+=</span> table[(table<span style=color:#f92672>.</span>index(value) <span style=color:#f92672>-</span> table<span style=color:#f92672>.</span>index(secret_key[index <span style=color:#f92672>%</span> len(secret_key)])) <span style=color:#f92672>%</span> <span style=color:#ae81ff>26</span>]
        num <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
    <span style=color:#66d9ef>return</span> plaintext

<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CrackVirginia</span>:
    <span style=color:#e6db74>&#39;&#39;&#39;破解&#39;&#39;&#39;</span>
    <span style=color:#75715e># 字母概率，从a到z</span>
    LETTER_PROBILITY <span style=color:#f92672>=</span> {
        <span style=color:#e6db74>&#39;a&#39;</span>:<span style=color:#ae81ff>0.08167</span>, <span style=color:#75715e># a</span>
        <span style=color:#e6db74>&#39;b&#39;</span>:<span style=color:#ae81ff>0.01492</span>, <span style=color:#75715e># b</span>
        <span style=color:#e6db74>&#39;c&#39;</span>:<span style=color:#ae81ff>0.02782</span>, <span style=color:#75715e># c</span>
        <span style=color:#e6db74>&#39;d&#39;</span>:<span style=color:#ae81ff>0.04253</span>, <span style=color:#75715e># d</span>
        <span style=color:#e6db74>&#39;e&#39;</span>:<span style=color:#ae81ff>0.12702</span>, <span style=color:#75715e># e</span>
        <span style=color:#e6db74>&#39;f&#39;</span>:<span style=color:#ae81ff>0.02228</span>, <span style=color:#75715e># f</span>
        <span style=color:#e6db74>&#39;g&#39;</span>:<span style=color:#ae81ff>0.02015</span>, <span style=color:#75715e># g</span>
        <span style=color:#e6db74>&#39;h&#39;</span>:<span style=color:#ae81ff>0.06094</span>, <span style=color:#75715e># h</span>
        <span style=color:#e6db74>&#39;i&#39;</span>:<span style=color:#ae81ff>0.06966</span>, <span style=color:#75715e># i</span>
        <span style=color:#e6db74>&#39;j&#39;</span>:<span style=color:#ae81ff>0.00153</span>, <span style=color:#75715e># j</span>
        <span style=color:#e6db74>&#39;k&#39;</span>:<span style=color:#ae81ff>0.00772</span>, <span style=color:#75715e># k</span>
        <span style=color:#e6db74>&#39;l&#39;</span>:<span style=color:#ae81ff>0.04025</span>, <span style=color:#75715e># l</span>
        <span style=color:#e6db74>&#39;m&#39;</span>:<span style=color:#ae81ff>0.02406</span>, <span style=color:#75715e># m</span>
        <span style=color:#e6db74>&#39;n&#39;</span>:<span style=color:#ae81ff>0.06749</span>, <span style=color:#75715e># n</span>
        <span style=color:#e6db74>&#39;o&#39;</span>:<span style=color:#ae81ff>0.07507</span>, <span style=color:#75715e># o</span>
        <span style=color:#e6db74>&#39;p&#39;</span>:<span style=color:#ae81ff>0.01929</span>, <span style=color:#75715e># p</span>
        <span style=color:#e6db74>&#39;q&#39;</span>:<span style=color:#ae81ff>0.00095</span>, <span style=color:#75715e># q</span>
        <span style=color:#e6db74>&#39;r&#39;</span>:<span style=color:#ae81ff>0.05897</span>, <span style=color:#75715e># r</span>
        <span style=color:#e6db74>&#39;s&#39;</span>:<span style=color:#ae81ff>0.06327</span>, <span style=color:#75715e># s</span>
        <span style=color:#e6db74>&#39;t&#39;</span>:<span style=color:#ae81ff>0.09056</span>, <span style=color:#75715e># t</span>
        <span style=color:#e6db74>&#39;u&#39;</span>:<span style=color:#ae81ff>0.02758</span>, <span style=color:#75715e># u</span>
        <span style=color:#e6db74>&#39;v&#39;</span>:<span style=color:#ae81ff>0.00978</span>, <span style=color:#75715e># v</span>
        <span style=color:#e6db74>&#39;w&#39;</span>:<span style=color:#ae81ff>0.02360</span>, <span style=color:#75715e># w</span>
        <span style=color:#e6db74>&#39;x&#39;</span>:<span style=color:#ae81ff>0.00150</span>, <span style=color:#75715e># x</span>
        <span style=color:#e6db74>&#39;y&#39;</span>:<span style=color:#ae81ff>0.01974</span>, <span style=color:#75715e># y</span>
        <span style=color:#e6db74>&#39;z&#39;</span>:<span style=color:#ae81ff>0.00074</span>, <span style=color:#75715e># z</span>
    }
    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__getSubstring</span>(self, key_length):
        <span style=color:#e6db74>&#39;&#39;&#39;分割为子串&#39;&#39;&#39;</span>
        num <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
        <span style=color:#66d9ef>while</span> num <span style=color:#f92672>&lt;</span> key_length:
            <span style=color:#66d9ef>yield</span> self<span style=color:#f92672>.</span>ciphertext[num::key_length]<span style=color:#f92672>.</span>upper()
            num <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__fangcha</span>(self, average, li):
        <span style=color:#e6db74>&#39;&#39;&#39;方差计算&#39;&#39;&#39;</span>
        tmp <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
        <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> li:
            tmp <span style=color:#f92672>+=</span> (x <span style=color:#f92672>-</span> average) <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span>
        <span style=color:#66d9ef>return</span> tmp <span style=color:#f92672>/</span> len(li)

    <span style=color:#66d9ef>def</span> __init__(self, ciphertext):
        self<span style=color:#f92672>.</span>ciphertext <span style=color:#f92672>=</span> ciphertext<span style=color:#f92672>.</span>upper()

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__IC_calculate</span>(self, string_str):
        <span style=color:#e6db74>&#39;&#39;&#39;无偏估计值计算&#39;&#39;&#39;</span>
        dict_ <span style=color:#f92672>=</span> {}
        <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> string_str:
            <span style=color:#66d9ef>try</span>:
                dict_[x] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
            <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>KeyError</span>:
                dict_[x] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
        tmp <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
        <span style=color:#66d9ef>for</span> value <span style=color:#f92672>in</span> dict_<span style=color:#f92672>.</span>values():
            <span style=color:#66d9ef>try</span>:
                tmp <span style=color:#f92672>+=</span> ((value <span style=color:#f92672>*</span> (value<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)) <span style=color:#f92672>/</span> (len(string_str) <span style=color:#f92672>*</span> (len(string_str) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)))
            <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ZeroDivisionError</span>:
                <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>
        <span style=color:#66d9ef>return</span> tmp

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__calculate_Mj</span>(self, text):
        <span style=color:#e6db74>&#39;&#39;&#39;拟重合指数法&#39;&#39;&#39;</span>
        Mj <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
        alpha <span style=color:#f92672>=</span> {}
        <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> text:
            <span style=color:#66d9ef>try</span>:
                alpha[x] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
            <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>KeyError</span>:
                alpha[x] <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
        <span style=color:#66d9ef>for</span> key, value <span style=color:#f92672>in</span> alpha<span style=color:#f92672>.</span>items():
            Mj <span style=color:#f92672>+=</span> ((self<span style=color:#f92672>.</span>LETTER_PROBILITY[key<span style=color:#f92672>.</span>lower()] <span style=color:#f92672>*</span> value) <span style=color:#f92672>/</span> len(text))
        <span style=color:#66d9ef>return</span> Mj

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>__getKeyLength</span>(self):
        <span style=color:#e6db74>&#39;&#39;&#39;破解密钥长度&#39;&#39;&#39;</span>
        key_length_ic <span style=color:#f92672>=</span> {}
        key_length_fangcha <span style=color:#f92672>=</span> {}
        key_length <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
        result <span style=color:#f92672>=</span> {}
        <span style=color:#66d9ef>while</span> key_length <span style=color:#f92672>&lt;</span> len(self<span style=color:#f92672>.</span>ciphertext):
            substring <span style=color:#f92672>=</span> []
            <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>__getSubstring(key_length):
                substring<span style=color:#f92672>.</span>append(x)
            key_length <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
            tmp <span style=color:#f92672>=</span> []
            <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> substring:
                ic <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>__IC_calculate(x)
                tmp<span style=color:#f92672>.</span>append(ic)
            <span style=color:#66d9ef>if</span> tmp:
                key_length_ic[str(key_length<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)] <span style=color:#f92672>=</span> math<span style=color:#f92672>.</span>fabs(sum(tmp) <span style=color:#f92672>/</span> len(tmp) <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.065</span>)
                key_length_fangcha[str(key_length<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)] <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>__fangcha(key_length_ic[str(key_length<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)], tmp)
        <span style=color:#66d9ef>for</span> key, value <span style=color:#f92672>in</span> key_length_ic<span style=color:#f92672>.</span>items():
            result[key] <span style=color:#f92672>=</span> key_length_fangcha[key] <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>+</span> value
        key_length <span style=color:#f92672>=</span> sorted(result<span style=color:#f92672>.</span>items(), key<span style=color:#f92672>=</span><span style=color:#66d9ef>lambda</span> a:a[<span style=color:#ae81ff>1</span>])[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>0</span>]
        <span style=color:#66d9ef>return</span> int(key_length)

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>crack</span>(self):
        <span style=color:#e6db74>&#39;&#39;&#39;破解&#39;&#39;&#39;</span>
        key_length <span style=color:#f92672>=</span> self<span style=color:#f92672>.</span>__getKeyLength()
        num <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
        key_ic <span style=color:#f92672>=</span> []
        <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>__getSubstring(key_length):
            <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>27</span>):
                s <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join([chr(((ord(l)<span style=color:#f92672>+</span>t<span style=color:#f92672>-</span><span style=color:#ae81ff>65</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>26</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>65</span>) <span style=color:#66d9ef>for</span> l <span style=color:#f92672>in</span> x])
                <span style=color:#66d9ef>try</span>:
                    key_ic[num]<span style=color:#f92672>.</span>append(math<span style=color:#f92672>.</span>fabs(self<span style=color:#f92672>.</span>__calculate_Mj(s) <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.065</span>))
                <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>IndexError</span>:
                    key_ic<span style=color:#f92672>.</span>append([math<span style=color:#f92672>.</span>fabs(self<span style=color:#f92672>.</span>__calculate_Mj(s) <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.065</span>)])
            num <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
        key <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
        <span style=color:#66d9ef>for</span> value <span style=color:#f92672>in</span> key_ic:
            key <span style=color:#f92672>+=</span> chr(ord(<span style=color:#e6db74>&#39;z&#39;</span>) <span style=color:#f92672>-</span> value<span style=color:#f92672>.</span>index(min(value)))
        <span style=color:#66d9ef>return</span> key

string <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;CHREEVOAHMAERATBIAXXWTNXBEEOPHBSBQMQEQERBWRVXUOAKXAOSXXWEAHBWGJMMQMNKGRFVGXWTRZXWIAKLXFPSKAUTEMNDCMGTSXMXBTUIADNGMGPSRELXNJELXVRVPRTULHDNQWTWDTYGBPHXTFALJHASVBFXNGLLCHRZBWELEKMSJIKNBHWRJGNMGJSGLXFEYPHAGNRBIEQJTAMRVLCRREMNDGLXRRIMGNSNRWCHRQHAEYEVTAQEBBIPEEWEVKAKOEWADREMXMTBHHCHRTKDNVRZCHRCLQOHPWQAIIWXNRMGWOIIFKEE&#39;</span>
a <span style=color:#f92672>=</span> CrackVirginia(string)
key <span style=color:#f92672>=</span> a<span style=color:#f92672>.</span>crack()
plaintext <span style=color:#f92672>=</span> decryptionVirginia(string, a<span style=color:#f92672>.</span>crack())
print(<span style=color:#e6db74>&#39;明文为:&#39;</span>, plaintext, end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#39;</span>)
print(<span style=color:#e6db74>&#39;加密密钥:&#39;</span>, key, end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#39;</span>)
print(<span style=color:#e6db74>&#39;加密后:&#39;</span>, string, end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#39;</span>)
print(<span style=color:#e6db74>&#39;破解密钥:&#39;</span>, key, end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#39;</span>)
print(<span style=color:#e6db74>&#39;破解明文:&#39;</span>, plaintext, end<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>&#39;</span>)
</code></pre></td></tr></table>
</div>
</div>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/tags/python/>python</a>
<a href=/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/>密码学</a>
<a href=/tags/vigenere/>Vigenere</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>Related contents</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/posts/python3-6%E5%AE%9E%E7%8E%B0aes-ecb/>
<div class=article-details>
<h2 class=article-title>Python3.6实现AES(ECB)</h2>
</div>
</a>
</article>
<article>
<a href=/posts/%E5%9B%BE%E7%89%87%E8%BD%AC%E5%AD%97%E7%AC%A6%E7%94%BB/>
<div class=article-details>
<h2 class=article-title>图片转字符画</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<div id=gitalk-container></div>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css>
<script src=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js></script>
<script>const gitalk=new Gitalk({clientID:"b8b69aaca9354fa6c0b3",clientSecret:"decd8028bd5d99f9f942efcc1e8bef298c7332a6",repo:"bankroft.github.io",owner:"bankroft",admin:["bankroft"],distractionFreeMode:!1,id:md5(location.pathname)});(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("gitalk-container").innerHTML="Gitalk comments not available by default when the website is previewed locally.";return}gitalk.render("gitalk-container")})()</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2019 -
2022 Bankroft
</section>
<section class=powerby>
<a target=_blank href=https://bankroft.github.io>The world is worth fighting for.</a> <br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.8.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">Table of contents</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li>
<ol>
<li>
<ol>
<li><a href=#代码>代码</a></li>
</ol>
</li>
</ol>
</li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>